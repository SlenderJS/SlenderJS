/**
 * SlenderJS - An open source JS Routing and Rendering library.
 * TwistPHP [ twistphp.com ]
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @version		1.4.0
 * @author		Dan Walker, James Durham
 * @license		https://www.gnu.org/licenses/gpl.html GPL License
 * @link		https://github.com/TwistPHP/SlenderJS
 */
!function(e,t,n,r){"function"==typeof define&&define.amd?define(r(t,n)):"object"==typeof exports?module.exports=r(t,n):e.SlenderJS=r(t,n)}(this,window,document,function(e,t){"use strict";return function(n,r){this.data=r||{},this.conf=n,new function(e){e.arrayKeys=function(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.inArray=function(e,t){return t.length&&t.indexOf(e)>-1},e.arrayParse=function(e,t,n){n=n||"/";let r=e.split(n);return e=r.splice(0,1),"object"==typeof r&&e in t?r.length?this.arrayParse(r.join(n),t[e],n):t[e]:null},e.isEmpty=function(e){return void 0===e||null==e||e.length<=0},e.closest=function(e,t){for(;!e.matches(t);)if(!(e=e.parentNode)||"BODY"===e.nodeName)return null;return e||null},e.preg_replace=function(e,t,n){return n.replace(e,t)},e.preg_match=function(e,t){return e.exec(t)},e.preg_match_all=function(e,t){let n=[],r=[...t.matchAll(e)];for(let e=0;e<r.length;e++){let t=[...r[e]];for(let e=0;e<t.length;e++)e in n||(n[e]=[]),n[e].push(t[e])}return n},e.parseUri=function(e){var n={},r=t.createElement("a");r.href=e;var a="protocol hostname host pathname port search hash href".split(" ");for(var o in a){var i=a[o];n[i]=r[i]}return n.toString=function(){return r.href},n.requestUri=n.pathname+n.search,n},e.parseQueryString=function(e){let n={},r=t.createElement("a");r.href=e;let a=r.search.substring(1).split("&");for(let e=0;e<a.length;e++){let t=a[e].includes("=")?a[e].split("="):[a[e],""];n[t[0]]=decodeURIComponent(t[1])}return n},e.csvToArray=function(e,t){t=t||",";const n=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,r=[[]];let a;for(;a=n.exec(e);)a[1].length&&a[1]!==t&&r.push([]),r[r.length-1].push(void 0!==a[2]?a[2].replace(/""/g,'"'):a[3]);return r},e.md5=function(e){var t="0123456789abcdef";function n(e){var n,r="";for(n=0;n<=3;n++)r+=t.charAt(e>>8*n+4&15)+t.charAt(e>>8*n&15);return r}function r(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function a(e,t,n,a,o,i){return r((s=r(r(t,e),r(a,i)))<<(l=o)|s>>>32-l,n);var s,l}function o(e,t,n,r,o,i,s){return a(t&n|~t&r,e,t,o,i,s)}function i(e,t,n,r,o,i,s){return a(t&r|n&~r,e,t,o,i,s)}function s(e,t,n,r,o,i,s){return a(t^n^r,e,t,o,i,s)}function l(e,t,n,r,o,i,s){return a(n^(t|~r),e,t,o,i,s)}var c,u,f,d,p,g=function(e){var t,n=1+(e.length+8>>6),r=new Array(16*n);for(t=0;t<16*n;t++)r[t]=0;for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*n-2]=8*e.length,r}(e),h=1732584193,m=-271733879,y=-1732584194,b=271733878;for(c=0;c<g.length;c+=16)u=h,f=m,d=y,p=b,h=o(h,m,y,b,g[c+0],7,-680876936),b=o(b,h,m,y,g[c+1],12,-389564586),y=o(y,b,h,m,g[c+2],17,606105819),m=o(m,y,b,h,g[c+3],22,-1044525330),h=o(h,m,y,b,g[c+4],7,-176418897),b=o(b,h,m,y,g[c+5],12,1200080426),y=o(y,b,h,m,g[c+6],17,-1473231341),m=o(m,y,b,h,g[c+7],22,-45705983),h=o(h,m,y,b,g[c+8],7,1770035416),b=o(b,h,m,y,g[c+9],12,-1958414417),y=o(y,b,h,m,g[c+10],17,-42063),m=o(m,y,b,h,g[c+11],22,-1990404162),h=o(h,m,y,b,g[c+12],7,1804603682),b=o(b,h,m,y,g[c+13],12,-40341101),y=o(y,b,h,m,g[c+14],17,-1502002290),m=o(m,y,b,h,g[c+15],22,1236535329),h=i(h,m,y,b,g[c+1],5,-165796510),b=i(b,h,m,y,g[c+6],9,-1069501632),y=i(y,b,h,m,g[c+11],14,643717713),m=i(m,y,b,h,g[c+0],20,-373897302),h=i(h,m,y,b,g[c+5],5,-701558691),b=i(b,h,m,y,g[c+10],9,38016083),y=i(y,b,h,m,g[c+15],14,-660478335),m=i(m,y,b,h,g[c+4],20,-405537848),h=i(h,m,y,b,g[c+9],5,568446438),b=i(b,h,m,y,g[c+14],9,-1019803690),y=i(y,b,h,m,g[c+3],14,-187363961),m=i(m,y,b,h,g[c+8],20,1163531501),h=i(h,m,y,b,g[c+13],5,-1444681467),b=i(b,h,m,y,g[c+2],9,-51403784),y=i(y,b,h,m,g[c+7],14,1735328473),m=i(m,y,b,h,g[c+12],20,-1926607734),h=s(h,m,y,b,g[c+5],4,-378558),b=s(b,h,m,y,g[c+8],11,-2022574463),y=s(y,b,h,m,g[c+11],16,1839030562),m=s(m,y,b,h,g[c+14],23,-35309556),h=s(h,m,y,b,g[c+1],4,-1530992060),b=s(b,h,m,y,g[c+4],11,1272893353),y=s(y,b,h,m,g[c+7],16,-155497632),m=s(m,y,b,h,g[c+10],23,-1094730640),h=s(h,m,y,b,g[c+13],4,681279174),b=s(b,h,m,y,g[c+0],11,-358537222),y=s(y,b,h,m,g[c+3],16,-722521979),m=s(m,y,b,h,g[c+6],23,76029189),h=s(h,m,y,b,g[c+9],4,-640364487),b=s(b,h,m,y,g[c+12],11,-421815835),y=s(y,b,h,m,g[c+15],16,530742520),m=s(m,y,b,h,g[c+2],23,-995338651),h=l(h,m,y,b,g[c+0],6,-198630844),b=l(b,h,m,y,g[c+7],10,1126891415),y=l(y,b,h,m,g[c+14],15,-1416354905),m=l(m,y,b,h,g[c+5],21,-57434055),h=l(h,m,y,b,g[c+12],6,1700485571),b=l(b,h,m,y,g[c+3],10,-1894986606),y=l(y,b,h,m,g[c+10],15,-1051523),m=l(m,y,b,h,g[c+1],21,-2054922799),h=l(h,m,y,b,g[c+8],6,1873313359),b=l(b,h,m,y,g[c+15],10,-30611744),y=l(y,b,h,m,g[c+6],15,-1560198380),m=l(m,y,b,h,g[c+13],21,1309151649),h=l(h,m,y,b,g[c+4],6,-145523070),b=l(b,h,m,y,g[c+11],10,-1120210379),y=l(y,b,h,m,g[c+2],15,718787259),m=l(m,y,b,h,g[c+9],21,-343485551),h=r(h,u),m=r(m,f),y=r(y,d),b=r(b,p);return n(h)+n(m)+n(y)+n(b)},e.date=function(e,t){let n,r;const a=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],o=/\\?(.?)/gi,i=function(e,t){return r[e]?r[e]():t},s=function(e,t){for(e=String(e);e.length<t;)e="0"+e;return e};return r={d:function(){return s(r.j(),2)},D:function(){return r.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return a[r.w()]+"day"},N:function(){return r.w()||7},S:function(){const e=r.j();let t=e%10;return["st","nd","rd"][(t=t<=3&&1===parseInt(e%100/10,10)?0:t)-1]||"th"},w:function(){return n.getDay()},z:function(){const e=new Date(r.Y(),r.n()-1,r.j()),t=new Date(r.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){const e=new Date(r.Y(),r.n()-1,r.j()-r.N()+3),t=new Date(e.getFullYear(),0,4);return s(1+Math.round((e-t)/864e5/7),2)},F:function(){return a[6+r.n()]},m:function(){return s(r.n(),2)},M:function(){return r.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(r.Y(),r.n(),0).getDate()},L:function(){const e=r.Y();return e%4==0&e%100!=0|e%400==0},o:function(){const e=r.n(),t=r.W(),n=r.Y();return n+(12===e&&t<9?1:1===e&&t>9?-1:0)},Y:function(){return n.getFullYear()},y:function(){return r.Y().toString().slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return r.a().toUpperCase()},B:function(){const e=3600*n.getUTCHours(),t=60*n.getUTCMinutes(),r=n.getUTCSeconds();return s(Math.floor((e+t+r+3600)/86.4)%1e3,3)},g:function(){return r.G()%12||12},G:function(){return n.getHours()},h:function(){return s(r.g(),2)},H:function(){return s(r.G(),2)},i:function(){return s(n.getMinutes(),2)},s:function(){return s(n.getSeconds(),2)},u:function(){return s(1e3*n.getMilliseconds(),6)},e:function(){throw new Error("Not supported (see source code of date() for timezone on how to add support)")},I:function(){const e=new Date(r.Y(),0),t=Date.UTC(r.Y(),0),n=new Date(r.Y(),6),a=Date.UTC(r.Y(),6);return e-t!=n-a?1:0},O:function(){const e=n.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+s(100*Math.floor(t/60)+t%60,4)},P:function(){const e=r.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-n.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(o,i)},r:function(){return"D, d M Y H:i:s O".replace(o,i)},U:function(){return n/1e3|0}},function(e,t){return n=void 0===t?new Date:t instanceof Date?new Date(t):new Date(1e3*t),e.replace(o,i)}(e,t)}}(this),this.func={},this.func.data=this.data,this.priv={},this.app=t.querySelector("#app")||null,this.currentPage=t.querySelector("#app .slenderPage.slenderPageCurrent")||null,this.nextPage=t.querySelector("#app .slenderPage.slenderPageNext")||null,new function(e){function t(t){return t in e.conf.hooks?e.conf.hooks[t]:[]}function n(t,n){return t in e.conf.hooks&&n in e.conf.hooks[t]?e.conf.hooks[t][n]:null}function r(t,n){return t.call(e,...n)}e.func.hooks={all:t,get:n,register:function(t,n,r){t in e.conf.hooks||(e.conf.hooks[t]=[]),e.conf.hooks[t][n]=r},cancel:function(t,n){if(t in e.conf.hooks){let r=e.conf.hooks[t].indexOf(n);r>-1&&e.conf.hooks[t].splice(r,1)}},fire:function(e,a,o){if(o){let t=n(e,o);return t&&"function"==typeof t?r(t,a):t}{let n=t(e);for(let e in n)n.hasOwnProperty(e)&&r(n[e],a)}return!1}},e.conf.hooks=e.conf.hooks||[]}(this),new function(e){e.func.render={build:n,buildRaw:r,addTemplate:function(t,n){e.conf.templates[t]=n,e.func.hooks.fire("render_add_template",[t,n])},isTemplate:function(t){return t in e.conf.templates}};let t={"/404.tpl":"<h1>Page not found!</h1>","/403.tpl":"<h1>Forbidden!</h1>"};function n(t,n){let a='Error: Template "'+t+'" not found',o=e.conf.currentTemplate;return t.startsWith("./")&&(t=(e.conf.currentTemplate.split("/").slice(0,-1).join("/")+"/"+t.replace("./","")).replace("//","/")),t in e.conf.templates&&(e.conf.currentTemplate=t,a=r(e.conf.templates[t],n)),e.conf.currentTemplate=o,a}function r(t,n){if("function"==typeof t)return t.call(e,...[n]);let r=function(t){let n=e.preg_match_all(/{([^{}]+)}/gi,t);return n.length>1?n[1]:[]}(t);if(r.length>0)for(let e=0;e<r.length;e++)t=a(t,r[e],n);return t}function a(t,n,r){if(n.includes(":")){let a=e.preg_match(/^([^?]+)\?([\w\W]+\:[\w\W]+)$/,n);if(a&&a.length){let i=e.preg_match_all(/(\)|\()?([\w\d\:\-\_\.\'\"\[\]\/]+)([\=\!]{3}|[=\>\<\*\^\!\$]{2}|[\<\>\*]{1})([\w\d\s\:\-\_\.\'\"\/]+)(\)|\()?(&&|\|\|)?/gi,a[1]);if(i.length>1){let c=[],u=!1,f=!1,d=!0,p=0,g="",h="",m="",y="";for(let t=0;t<i[1].length;t++){let n=i[1][t];u=!u&&"("===n||u;let a=i[2][t].includes(":")?i[2][t].split(":"):null,s=i[4][t].includes(":")?i[4][t].split(":"):null,b="",v="";e.isEmpty(a)||(m="{"+i[2][t]+"}",b=i[2][t]),e.isEmpty(s)||(y="{"+i[4][t]+"}",v=i[4][t]);let P=e.isEmpty(a)?i[2][t]:o(m,b,a[0],a[1],r,!0),w=e.isEmpty(s)?i[4][t]:o(y,v,s[0],s[1],r,!0);w=w===y?"twst-undefined-variable":w;let k=l(P=P===m?"twst-undefined-variable":P,i[3][t],w);f=")"===i[5][t],(e.inArray(h,["&&",""])&&d||"||"===h&&!d||!1===u&&d)&&(d=k),(!1===u||u&&f)&&(!e.inArray(g,["&&",""])||p in c&&!0!==c[p]?"||"===g&&(c[++p]=d):c[p]=d,u=f=!1,d=!0,h=""),u?h=i[6][t]:g=i[6][t]}let b=!1;for(let e=0;e<c.length;e++)b=!!c[e]||b;if(c=e.preg_match_all(/(\'([^\']*)\'|\"([^\"]*)\"|([\d]+)|([\w\.\-\_\/\[]+:[\w\.\_\-\/\]]+)):?/gi,a[2]),e.isEmpty(c[5][b?0:1])){let r=b?0:1,a="";e.isEmpty(c[2][r])?e.isEmpty(c[3][r])?e.isEmpty(c[4][r])||(a=c[4][r]):a=c[3][r]:a=c[2][r],t=s(t,n,a)}else{let a=c[5][b?0:1].split(":"),i=e.md5(t);t=o(t,n,a[0],a[1],r),i===e.md5(t)&&(t=s(t,n,""))}}}else{let e=n.split(":"),a=e[0];e.splice(0,1);let i=e.join(":");t=o(t,n,a,i,r)}}return t}function o(t,r,a,l,u,f){f=f||!1;let d="",p=[],g="";if(e.conf.currentTag=r,a.includes("[")&&l.includes("]")){let e=a.split("[");d=e[0],a=e[1],l=l.replace(/\]$/gi,"")}else(p=e.preg_match(/(.*)\[(.*)\:(.*)\]/gi,r))&&(d=p[1],a=p[2],l=p[3]);let h=function(t,n){n=n||[];let r=[],a=e.csvToArray(t,",")[0];if(a.length){t=a[0],a.splice(0,1);for(let e=0;e<a.length;e++){let t=a[e];if(t.includes("=")){let e=t.split("="),a=e[0],i=e[1];if(i.includes(":")){let e=i.split(":");2===e.length&&(i=o("{"+i+"}",i,e[0],e[1],n))}i=c(i),r[a]=i.includes("|")?i.split("|"):i}else t.includes("|")?(t=c(t),r.push(t.includes("|")?t.split("|"):t)):(t=c(t),r[t]=!0)}}return[t,r]}(l,u);switch(l=h[0],"remove-tags"in(h=h[1])&&h["remove-tags"],"process-tags"in h&&h["process-tags"],a){case"data":case"setting":case"global":let o=i(l,"data"===a?u:e.data,f);!0===o.status&&(t=s(t,r,o.return,d,o.return_raw,h));break;case"date":g=e.date(l),t=s(t,r,g,d,[],h);break;case"view":e.conf.viewParams=h,u="object"==typeof u?{...u,...h}:h,l.startsWith("./")&&(l=(e.conf.currentTemplate.split("/").slice(0,-1).join("/")+"/"+l.replace("./","")).replace("//","/")),g=n(l,u),t=s(t,r,g,d,[],h);break;case"repeater":if(e.conf.viewParams=h,!e.isEmpty(h.view)&&l in u&&u[l].length){e.func.hooks.register("render_tags","parent",u);for(let e=0;e<u[l].length;e++)u[l][e].repeater_index=e,g+=n(h.view,u[l][e]);e.func.hooks.cancel("render_tags","parent")}t=s(t,r,g,d,[],h);break;default:let c=e.func.hooks.fire("render_tags",[l,u,h],a);if(!e.isEmpty(c)){if("object"==typeof c){let e=i(l,c,f);!0===e.status&&(c=e.return)}t=s(t,r,c,d,[],h)}}return t}function i(t,n,r){r=r||!1;let a={status:!1,return:"",return_raw:""};if("object"==typeof n)if(t.includes("/")){let o=e.arrayParse(t,n);a.status=!e.isEmpty(o),a.return="object"==typeof n[t]&&!1===r?JSON.stringify(o,null,4):o,a.return_raw=o}else t in n&&(a.status=!0,a.return="object"==typeof n[t]&&!1===r?JSON.stringify(n[t],null,4):n[t],a.return_raw=n[t]);return a}function s(t,n,r,a,o,i){if(!e.isEmpty(a)){let t=["count","strlen","strtolower","strtoupper","date"];if(e.inArray(a,t))switch(a){case"count":case"strlen":r=o.length;break;case"strtolower":r=o.toLowerCase();break;case"strtoupper":r=o.toUpperCase();break;case"date":let t="Y-m-d H:i:s";"format"in i?t=i.format:0 in i?t=i[0]:1===i.length&&(t=e.arrayKeys(i).splice(0,1)),r=e.date(t,Date.parse(r))}else console.error("SlenderJS :: function '"+a+"' is not available")}return t.replace("{"+n+"}",r)}function l(t,n,r){let a=!1;switch(t=c(t),r=c(r),n){case"===":a=t===r;break;case"!==":a=t!==r;break;case"==":a=t==r||""==t&&"twst-undefined-variable"===r||""==r&&"twst-undefined-variable"===t;break;case"<":a=t<r;break;case">":a=t>r;break;case"<=":a=t<=r;break;case">=":a=t>=r;break;case"!=":a=t!=r;break;case"*":a=e.inArray(r,t);break;case"^=":a=t.substr(0,r.length)==r;break;case"*=":a=t.indexOf(r);break;case"=":a=t.substr(t.length-r.length,r.length)==r}return a}function c(t){if("boolean"!=typeof t&&"object"!=typeof t){let n=t.length;t="''"===t||'""'===t?"":t,t=e.preg_replace(/^([\'|\"]{1})([\W\w]+)([\'|\"]{1})/gi,"$2",t);let r=n===t.length;r&&"null"===t?t=null:r&&"undefined"===t?t="twst-undefined-variable":r&&"true"===t?t=!0:r&&"false"===t?t=!1:r&&e.preg_match(/^[0-9]+\.[0-9]+/gi,t)?t=parseFloat(t):r&&"number"==typeof t&&(t=parseInt(t))}return t}e.conf.templates={...t,...e.conf.templates}||t,e.conf.viewParams=e.conf.viewParams||[],e.conf.currentTag=e.conf.currentTag||null,e.conf.currentTemplate=e.conf.currentTemplate||null}(this),new function(n){n.func.router={start:o,page:l,addRoute:i,addRedirect:s,findRoute:function(e,t,r){const a=(e,t,n,r,a)=>{let o=[];switch(n){case"path":for(let n in e)(r&&n===t||!r&&n.toLowerCase().includes(t.toLowerCase()))&&(o[n]=e[n]);break;default:for(let i in e)n in e[i]&&(r&&e[i][n]==t||!r&&a.inArray(typeof e[i][n],["boolean","number","float","integer"])&&e[i][n]==t||!r&&"string"==typeof e[i][n]&&e[i][n].toLowerCase().includes(t.toLowerCase())||!r&&"object"==typeof e[i][n]&&a.inArray(t,e[i][n]))&&(o[i]=e[i])}return o};let o=n.conf.routes;for(let i=0;i<e.length;i++)o=a(o,e[i],t[i],r[i],n);return o}},n.priv.router={start:o,page:l,pageReady:function(){let r=n.currentPage.getAttribute("data-path"),a=r in n.conf.routes?n.conf.routes[r]:n.conf.routes[404];c(a),t.querySelectorAll("[data-slender-livejs]").forEach(function(e,t){e.remove()});let o=[],i=n.currentPage.querySelectorAll("script");for(let e=0;e<i.length;e++){let t={contents:i[e].text||i[e].textContent||i[e].innerHTML||""};o.push(t),i[e].remove()}u("script",o,!0,"livejs"),n.func.hooks.fire("router_page_ready",[r,a]),n.data.isLoadedInterval=setInterval(function(n,r,a){0===t.querySelectorAll('[data-slender-loaded="0"]').length&&(clearInterval(n.data.isLoadedInterval),e.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0})),console.log("SlenderJS :: DOMContentLoaded"),n.func.hooks.fire("router_page_domcontentloaded",[r,a]))},200,n,r,a)},addRoute:i,addRedirect:s,generateTags:u,createPageContainer:function(e,r){let a=t.createElement("div");a.classList.add("slenderPage","slenderPageNext","slenderPageHidden"),a.setAttribute("data-path",e),a.innerHTML=r,n.app.appendChild(a),n.nextPage=n.app.querySelector(".slenderPage.slenderPageNext")}};let r=[{charset:"UTF-8"},{name:"viewport",content:"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"},{"http-equiv":"X-UA-Compatible",content:"ie=edge"}],a={404:{title:"Page Not Found",template:"/404.tpl"},403:{title:"Permission Denied",template:"/403.tpl"}};function o(r,a){let o=r||!1;n.data.startPath=a||e.location.pathname,n.data.GET=n.parseQueryString(e.location.href),u("meta",n.conf.meta,!1),u("style",n.conf.style,!1),u("script",n.conf.script,!1),u("link",n.conf.link,!1),n.currentPage||(n.app.innerHTML='<div class="slenderPage slenderPageCurrent"></div>',n.currentPage=n.app.querySelector(".slenderPage.slenderPageCurrent")),u("style",[{contents:".slenderPage{ display:block; } .slenderPage.slenderPageHidden{ display:none!important;"}]),o?(console.log("Waiting for DOM to load ..."),n.data.isLoadedInterval=setInterval(function(e){0===t.querySelectorAll('[data-slender-loaded="0"]').length&&(clearInterval(e.data.isLoadedInterval),console.log("Render Page ... ["+e.data.startPath+"]"),e.func.router.page(e.data.startPath,e.data.GET))},200,n)):l(n.data.startPath,n.data.GET)}function i(e,t){n.conf.routes[e]=t,n.func.hooks.fire("router_add_route",[e,t])}function s(e,t){n.conf.routes[e]={redirect:t},n.func.hooks.fire("router_add_redirect",[e,t])}function l(t,r){r=r||{};var a=t in n.conf.routes?n.conf.routes[t]:"rc"in r?n.conf.routes[r.rc]:{redirect:t+"?rc=404"};if("redirect"in a)return e.location.href=a.redirect,!0;a.title=a.title||"",a.template=a.template||"",a.data=a.data||[],a.meta=a.meta||[],a.preventLoad=!1,n.func.hooks.fire("router_page",[t,a]),a.preventLoad||function(t,r,a,o){n.func.hooks.fire("router_page_transition",[t,r,a,o],n.conf.transition),e.history.pushState({pageBody:a,pageTitle:r,pageInfo:o},r,t)}(t,a.title,function(e,t){return n.func.hooks.fire("router_page_body",[e,t]),n.func.render.build(t.template,t.data)}(t,a),a),a.preventLoad=!1}function c(e){let r=t.querySelector("head title");return r.innerHTML=e.title,t.title=e.title,u("meta",e.meta,!0),u("style",e.style,!0),u("script",e.script,!0),u("link",e.link,!0),n.func.hooks.fire("router_page_head",[e]),""}function u(e,r,a,o){let i=!n.isEmpty(o);if(o=o||e,r=r||[],!(a=a||!1)&&i&&t.querySelectorAll("[data-slender-"+o+"]").length)return!0;if(a&&t.querySelectorAll("[data-slender-"+o+"]").forEach(function(e,t){e.remove()}),r.length){let n=a?t.querySelector("head title").nextSibling:t.querySelector("head title");for(let s=0;s<r.length;s++){let l=t.createElement(e);Object.keys(r[s]).forEach(e=>{"contents"===e?l.innerHTML=r[s][e]:l.setAttribute(e,r[s][e])}),(a||i)&&l.setAttribute("data-slender-"+o,""),"rel"in r[s]&&"canonical"===r[s].rel||!("href"in r[s]||"src"in r[s])||(l.setAttribute("data-slender-loaded","0"),l.onload=function(e){e.target.setAttribute("data-slender-loaded","1")}),t.querySelector("head").insertBefore(l,n)}}}n.conf.transition=n.conf.transition||"default",n.conf.meta={...r,...n.conf.meta}||r,n.conf.script=n.conf.script||[],n.conf.link=n.conf.link||[],n.conf.style=n.conf.style||[],n.conf.domains=n.conf.domains||[],n.conf.routes={...a,...n.conf.routes}||a,n.func.hooks.register("router_page_transition","default",function(e,t,n,r){this.priv.router.createPageContainer(e,n),this.currentPage.remove(),this.nextPage.classList.remove("slenderPageNext","slenderPageHidden"),this.nextPage.classList.add("slenderPageCurrent"),this.currentPage=this.nextPage,this.nextPage=null,this.priv.router.pageReady()}),n.func.hooks.register("router_page_transition","fade",function(e,t,n,r){this.priv.router.createPageContainer(e,n),this.priv.router.generateTags("style",[{contents:".slenderFadeIn{opacity: 1!important;} .slenderFadeOut{opacity: 0!important;}"}],!1,"transitionFade"),this.currentPage.style.opacity="1",this.currentPage.style.transition="opacity 0.5s",this.nextPage.style.opacity="0",this.nextPage.style.transition="opacity 0.5s ease-in-out 0.5s",this.nextPage.classList.remove("slenderPageNext","slenderPageHidden"),this.nextPage.classList.add("slenderPageCurrent","slenderFadeIn"),this.currentPage.classList.add("slenderFadeOut"),setTimeout(function(e){e.currentPage.remove()},490,this),setTimeout(function(e){e.currentPage=e.nextPage,e.nextPage=null,e.priv.router.pageReady()},510,this)}),e.onpopstate=function(e){e.state&&(t.title=e.state.pageTitle,t.body.innerHTML=e.state.pageBody,c(e.state.pageInfo))},e.addEventListener("click",function(e){let t=null,r=n.closest(e.target,"a"),a=n.closest(e.target,"[data-smart-route]");if(r?t=r.getAttribute("href"):a&&(t=a.getAttribute("data-smart-route")),t){let r=n.parseUri(t);t&&!t.startsWith("#")&&(t.startsWith("/")||n.inArray(r.hostname,n.conf.domains))&&(e.preventDefault(),n.data.GET=n.parseQueryString(t),l(r.pathname,n.data.GET))}})}(this),e.SlenderJS=this.func}});